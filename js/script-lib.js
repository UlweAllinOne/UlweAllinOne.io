var myCurrentReq=document.getElementById("myscriptLib").getAttribute("myCustomAttrib"),map={},deliveryCharge=0,disc=0,context="https://m8gohcb5gc.execute-api.ap-south-1.amazonaws.com/dev/"+myCurrentReq+"/",contextCommon="https://m8gohcb5gc.execute-api.ap-south-1.amazonaws.com/dev/common/",category=myCurrentReq.charAt(0).toUpperCase(),typeName=category+myCurrentReq.substr(1),fetchMethod="getAll"+typeName+"Products",successUrl=typeName+"index.html",saveMethod="save"+typeName+"Orders",masterMethod="get"+typeName+"MasterData";function initMap(t){$("#lodaingModal").modal("show"),$.ajax({type:"POST",url:context+fetchMethod,success:function(a){$(a).each(function(){map[$(this).attr("id")]=$(this).attr("productName")+","+$(this).attr("maxPrice")+","+$(this).attr("minPrice")+","+$(this).attr("discount")+","+$(this).attr("productDesc")+","+$(this).attr("stockStatus")}),"H"==t&&generateProduct(),localStorage.setItem(myCurrentReq+"mymap",JSON.stringify(map)),setTimeout(hidePopup,500)},error:function(t){setTimeout(hidePopup,500),alert(t)}})}function hidePopup(){$("#lodaingModal").modal("hide")}function cardCount(){var t=0,a=localStorage.getItem(myCurrentReq+"card");null!=a&&$.each(a.split(","),function(a,e){"null"!=e&&""!=e&&""!=e.split("#")[0]&&t++}),$(".cardCount").html("["+t+"]")}function addtoCard(t,a){var e=t+"#"+$(a).parent().parent().find("input").eq(0).val();return localStorage.setItem(myCurrentReq+"card",localStorage.getItem(myCurrentReq+"card")+","+e),alert(map[t].split(",")[0]+" successfully added to cart."),cardCount(),!1}function calcuateAmt(t,a,e,r){if($(t).val()>0&&$(t).val()<10){var s=$(t).val()*e;$("#totVal"+a).html(s+" Rs").attr("data-val",r+","+$(t).val())}return mainTotal(),!1}cardCount();var finalOrderDetails="",sum=0;function mainTotal(){sum=0,$.each($(".total"),function(t,a){var e=$(a).html().split(" ");sum+=parseInt(e[0])}),$("#finalTotal").html(sum+" Rs"),sum<=50?deliveryCharge=20:sum<=100&&sum>50?deliveryCharge=10:sum<=200&&sum>101?deliveryCharge=5:sum>200&&(deliveryCharge=0),"A"!=category&&"V"!=category||(disc=0,deliveryCharge=0),$("#deliveryCharge").html(deliveryCharge+" Rs"),$("#disc").html(disc+" Rs");var t=parseInt(sum)+parseInt(deliveryCharge)+parseInt(disc);$("#mainTotal").html(t+" Rs"),finalOrderDetails=sum+","+t}function removeProduct(t,a){disc=0;var e=localStorage.getItem(myCurrentReq+"card");return e=e.replace(t,""),localStorage.setItem(myCurrentReq+"card",e),$("#sectiondetails"+a).remove(),mainTotal(),cardCount(),!1}function initCart(){map=JSON.parse(localStorage.getItem(myCurrentReq+"mymap")),displayCardDetails()}function displayCardDetails(){var t="";"A"==category&&(t="display:none");var a=localStorage.getItem(myCurrentReq+"card");$.each(a.split(","),function(a,e){if("null"!=e&&""!=e){var r=e.split("#")[1];null==r&&(r=1);var s=e.split("#")[0];if(""!=s){var i=map[s].split(","),o=i[2]*r,l="return removeProduct('"+e+"',"+a+")",n='<div class="col-md-6 col-lg-3 ftco-animate fadeInUp ftco-animated" id="sectiondetails'+a+'"><div class="product"><a href="#" style="text-align: center" class="img-prod"><img class="img-fluid" src="images/product-'+s+'.jpg" alt="Colorlib Template"><div class="overlay"></div></a><div class="text py-3 pb-4 px-3 text-center"><h3><a href="#">'+i[0]+'</a></h3><div class="pricing123"><p class="price"><span class="price-sale" style="'+t+'" >Price - '+i[2]+' Rs</span><br><span style="'+t+'" class="price-sale">&nbsp;&nbsp;Quantity - '+r+'</span><br><span class="price-sale" style="'+t+'">&nbsp;&nbsp;Final Price - '+o+' Rs</span><br><span class="price-sale">&nbsp;&nbsp;<input type="button" value="Remove from cart" onclick="'+l+'" class="btn btn-primary"  ></span><span class="total" style="display:none" data-val="'+s+","+r+'" id="totVal'+a+'">'+o+" Rs</span></p></div></div></div></div>";$("#cardDetailsData").append(n)}}}),mainTotal()}function checkQty(t){""!=$(t).val()&&($(t).val()>0&&$(t).val()<10||$(t).val("1"))}function generateProduct(){var t="";"A"==category&&(t="display:none"),$.map(map,function(a,e){var r=a.split(",");if("D"!=r[5]){var s,i="";""!=r[3]&&" "!=r[3]&&(i='<span class="status">'+r[3]+"</span>"),s="Y"==r[5]?'<br><span style="'+t+'"> Quantity <input type="number" value="1" min="1" max="9" onKeyup="return checkQty(this)" size="4" style="margin-bottom: 6px;text-align: center;"></span><input type="button" onClick="return addtoCard('+e+',this)" class="btn btn-primary" value="Add to Cart">':'<span style="'+t+'" class="btn btn-danger">Out of Stock</span>';var o="";o=r[2]==r[1]?'<span class="price-sale" style="'+t+'">'+r[2]+" Rs</span>":'<span class="mr-2 price-dc" style="'+t+'">'+r[1]+' Rs</span><span class="price-sale">'+r[2]+" Rs</span>";var l='<div class="col-md-6 col-lg-3 ftco-animate fadeInUp ftco-animated productNameClass" data-id="'+r[0]+'" ><div class="product"><a href="#" class="img-prod" style="text-align: center"><img class="img-fluid" src="images/product-'+e+'.jpg" alt="UlweAllinOne">'+i+'<div class="overlay"></div></a><div class="text py-3 pb-4 px-3 text-center"><h3><a href="#">'+r[0]+'</a></h3><div class=""><div class="pricing123"><p class="price" >'+o+'<span class="price-sale" >&nbsp;&nbsp;</span>'+s+"</p></div></div></div></div></div>";$("#productDetails").append(l)}})}function displaySearchResult(t){""!=$(t).val()?$(".productNameClass").each(function(){-1==$(this).attr("data-id").toLowerCase().indexOf($(t).val().toLowerCase())&&$(this).hide()}):$(".productNameClass").show()}function closePopup(){$("#lodaingModal").modal("hide"),localStorage.removeItem(myCurrentReq+"mymap"),localStorage.removeItem(myCurrentReq+"card"),location.href=successUrl}function applyCoupon(){return mainTotal(),"NODELVCHG"==$("#coupontxt").val()&&sum<200?(disc="-"+deliveryCharge,mainTotal(),alert("Coupon applyed successfully.")):"ULWEOFF10"==$("#coupontxt").val()&&sum>200?(disc="-10",mainTotal(),alert("Coupon applyed successfully.")):alert("Sorry No Coupon is availabel with this code."),!1}function placeOrder(){if(""==$("#fname").val())return alert("Please enter your Name."),$("#fname").focus(),!1;if(""==$("#streetAddress").val())return alert("Please enter Address."),$("#streetAddress").focus(),!1;if(""==$("#mobileNo").val())return alert("Please enter Mobile Number."),$("#mobileNo").focus(),!1;if(10!=$("#mobileNo").val().length)return alert("Please enter 10 digit Mobile Number."),$("#mobileNo").focus(),!1;if(""==$("#emailid").val())return alert("Please enter emailid."),$("#emailid").focus(),!1;if(1==confirm("Are you sure you want to place order?")){$("#lodaingModal").modal("show"),$("#closeButton").hide();var t=finalOrderDetails;$("#finalTotal").html(t.split(",")[0]),$("#deliveryCharge").html(deliveryCharge),$("#disc").html(disc),$("#mainTotal").html(t.split(",")[1]);var a={};a.userName=$("#fname").val()+" "+$("#lname").val(),a.address=$("#sector").val()+", "+$("#apartment").val()+", "+$("#streetAddress").val()+", "+$("#city").val()+", "+$("#pincode").val(),a.emailid=$("#emailid").val(),a.mobileNo=$("#mobileNo").val(),a.devCharge=deliveryCharge,a.discount=disc,a.totPrice=t.split(",")[0],a.finalPrice=t.split(",")[1];var e="";$(".total").each(function(){e=e+$(this).attr("data-val")+"#"}),e=e.substr(0,e.length-1),a.orderDetails=e,$.ajax({type:"POST",url:context+saveMethod,data:JSON.stringify(a),success:function(t){$("#orderConfirmationContent").html(t),$("#closeButton").show()},error:function(t){$("#lodaingModal").modal("hide"),$("#closeButton").show(),alert(t)}})}}function initMasterRates(){$("#lodaingModal").modal("show");var t='{"category":"'+category+'","password":"'+$("#password").val()+'"}';$.ajax({type:"POST",url:context+masterMethod,data:t,success:function(t){setTimeout(hidePopup,500),generateMaster(t)},error:function(t){setTimeout(hidePopup,500),alert(t.responseJSON)}})}function initOrderDetails(){$("#lodaingModal").modal("show");var t='{"category":"'+category+'","password":"'+$("#password").val()+'"}';$.ajax({type:"POST",url:contextCommon+"getOrderHistory",data:t,success:function(t){setTimeout(hidePopup,500),generateDetails(t)},error:function(t){setTimeout(hidePopup,500),alert(t.responseJSON)}})}function generateMaster(t){var a="";a="<table><tr><th>ID</th><th>Product Name</th><th>Product Description</th><th>Min Price</th><th>Max Price</th><th>Status</th><th>Update</th></tr>";var e=1;$(t).each(function(t,r){a=a+'<tr><td><input type="text" size="1" id="id'+t+'" readonly value="'+$(r).attr("id")+'"></td><td><input id="productName'+t+'" type="text" value="'+$(r).attr("productName")+'"></td><td><input id="productdesc'+t+'" type="text" value="'+$(r).attr("productDesc")+'"></td><td><input type="text" id="minVal'+t+'" size="2" value="'+$(r).attr("minPrice")+'"></td><td><input id="maxVal'+t+'" type="text" size="2" value="'+$(r).attr("maxPrice")+'"></td><td><input type="text" size="2" id="stockStatus'+t+'" value="'+$(r).attr("stockStatus")+'"></td><td><input type="button" onClick="return updateRow('+t+')" value="Update" /></tr>',e=$(r).attr("id")}),$("#orderDetails").html(addNewRow(a,++e))}function addNewRow(t,a){return t+'<tr><td><input type="text" size="1" id="id'+a+'" value="'+a+'"></td><td><input id="productName'+a+'" type="text"></td><td><input id="productdesc'+a+'" type="text"></td><td><input type="text" id="minVal'+a+'" size="2" ></td><td><input id="maxVal'+a+'" type="text" size="2" ></td><td><input type="text" size="2" id="stockStatus'+a+'" ></td><td><input type="button" onClick="return updateRow('+a+')" value="Add New Record" /></tr></table>'}function updateRow(t){var a={};if(a.category=category,a.password=$("#password").val(),a.minVal=$("#minVal"+t).val(),a.maxVal=$("#maxVal"+t).val(),a.productName=$("#productName"+t).val(),a.productDesc=$("#productdesc"+t).val()," "!=$("#maxVal"+t).val()){var e=parseInt($("#maxVal"+t).val())-parseInt($("#minVal"+t).val());e=0==(e=e/parseInt($("#maxVal"+t).val())*100)?" ":Math.trunc(e)+"%"}else e=" ";return a.discount=e,a.id=$("#id"+t).val(),a.stockStatus=$("#stockStatus"+t).val(),updateTables(JSON.stringify(a),"updateProductMaster","initMasterRates"),!1}function generateDetails(t){$("#orderDetails").html("");var a="",e="",r=1,s="";$(t).each(function(t,i){var o="";"Delivered"!=$($(i).attr("master")).attr("orderStatus")&&(o='<select id="statusddval'+r+'"><option value="In-Progress">In-Progress</option><option value="Delivered">Delivered</option><option value="UnReachable">UnReachable</option><option value="Out of Stock">Out of Stock</option></select>&nbsp;&nbsp;<input type="button" data-id="'+$($(i).attr("master")).attr("id")+'"  data-emailid="'+$($(i).attr("user")).attr("emailid")+'" data-name="'+$($(i).attr("user")).attr("userName")+'" class="btn btn-primary" onclick="return updatestatus(this,'+r+')" value="update" />'),e!=$($(i).attr("user")).attr("datetime").substr(0,10)?(a=a.replace("#runtime#",s),s=(s="")+"<p>"+r+'. <input type="button" data-id='+$($(i).attr("master")).attr("id")+' onClick="return viewOrderDetails(this)" value="OrderDetails" /> OrderId <b>'+$($(i).attr("master")).attr("orderid")+"</b> placed by <b>"+$($(i).attr("user")).attr("userName")+"</b> using Mobile No. <b>"+$($(i).attr("user")).attr("mobileNo")+"</b> with Total amount <b>"+$($(i).attr("master")).attr("finalPrice")+" Rs. Address Details :</b> "+$($(i).attr("user")).attr("address")+". having order status <b>"+$($(i).attr("master")).attr("orderStatus")+"</b>."+o,a=a+'<div class="col-sm-12"><div class="cart-wrap ftco-animate fadeInUp ftco-animated"><div class="cart-total mb-3"><h3>'+$($(i).attr("user")).attr("datetime").substr(0,10)+'</h3><div id="detailssub">#runtime#</div></div></div></div>',e=$($(i).attr("user")).attr("datetime").substr(0,10)):s=s+"<p>"+r+'. <input type="button" data-id='+$($(i).attr("master")).attr("id")+' onClick="return viewOrderDetails(this)" value="OrderDetails" /> OrderId <b>'+$($(i).attr("master")).attr("orderid")+"</b> placed by <b>"+$($(i).attr("user")).attr("userName")+"</b> using Mobile No. <b>"+$($(i).attr("user")).attr("mobileNo")+"</b> with Total amount <b>"+$($(i).attr("master")).attr("finalPrice")+" Rs. Address Details :</b> "+$($(i).attr("user")).attr("address")+". having order status <b>"+$($(i).attr("master")).attr("orderStatus")+"</b>."+o,r++}),a=a.replace("#runtime#",s),$("#orderDetails").append(a)}function viewOrderDetails(t){var a='{"category":"'+category+'","id":"'+$(t).attr("data-id")+'"}';$.ajax({type:"POST",url:"https://m8gohcb5gc.execute-api.ap-south-1.amazonaws.com/dev/common/getOrderDetailsData",data:a,success:function(t){generateTabularFormat(t)},error:function(t){alert(t)}})}function generateTabularFormat(t){var a="<ol>";$(t).each(function(t,e){a=a+"<li>"+e+"</li>"}),a+="</ol>",$("#exampleModalLabel").html("Below are Order Details"),$(".modal-body").html(a),$("#lodaingModal").modal("show")}function updatestatus(t,a){var e={};e.category=category,e.password=$("#password").val(),e.masterid=$(t).attr("data-id"),e.status=$("#statusddval"+a).val(),e.name=$(t).attr("data-name"),e.emailid=$(t).attr("data-emailid"),updateTables(JSON.stringify(e),"updateOrderStatus","initOrderDetails")}function updateTables(data,method,call){$.ajax({type:"POST",url:contextCommon+method,data:data,success:function(response){alert(response),eval(call+"()")},error:function(t){alert(t)}})}function submitViewOrder(){$("#ordersection").hide(),$.ajax({type:"POST",url:contextCommon+"findOrder",data:'{"orderid":"'+$("#Orderid").val()+'"}',success:function(t){var a="";$("#orderHeader").html("Thanks "+$($(t).attr("user")).attr("userName")+" for placing order with UlweAllInOne online Store."),a=(a=(a=(a=a+"<p> Your order was placed on "+$($(t).attr("master")).attr("datetime")+". Order status is "+$($(t).attr("master")).attr("orderStatus")+". </p>")+"<p> Delivery person will contact you on mobile no "+$($(t).attr("user")).attr("mobileNo")+", or email id "+$($(t).attr("user")).attr("emailid")+". </p>")+"<p> Delivery address is "+$($(t).attr("user")).attr("address")+". </p>")+'<p><input type="button" value="Your Order Details" class="btn btn-primary"  data-id='+$($(t).attr("master")).attr("id")+' onClick="return viewOrderDetails(this)" /> </p>',$("#detailssub").html(a),$("#ordersection").show(),category=$($(t).attr("master")).attr("catagory")},error:function(t){alert("Please enter valid Order ID. Order ID is send to you via email and SMS.")}})}